Zabbix Community Dockerfiles
Zabbix Github repo is intended
as a source for Zabbix Docker registry.
Please use these community Zabbix Docker images, if you want to
build/ship your own Zabbix Docker image.

zabbix-server-2.4 Circle CI 
Compiled zabbix-server with almost all features (MySQL, Java, SNMP, Curl, IPMI,
IPv6, Jabber) and Zabbix web UI based on CentOS 7, Supervisor, Nginx, PHP. Image
requires external MySQL/MariaDB database (you can run MySQL/MariaDB also as
Docker container).

Standard Dockerized Zabbix server usage
# create /var/lib/mysql as persistent volume storage 
docker run -d -v /var/lib/mysql --name zabbix-db-storage busybox:latest

# start DB for zabbix server - default 1GB innodb_buffer_pool_size is used
docker run \
    -d \
    --name zabbix-db \
    -p 3306:3306 \
    --volumes-from zabbix-db-storage \
    --env="MARIADB_USER=zabbix" \
    --env="MARIADB_PASS=my_password" \
    zabbix/zabbix-db-mariadb

# wait 60 seconds for DB initialization    
sleep 60

# start Zabbix server linked to started DB    
docker run \
    -d \
    --name zabbix-server \
    -p 80:80 \
    -p 10051:10051 \
    --link zabbix-db:zabbix.db \
    --env="ZS_DBHost=zabbix.db" \
    --env="ZS_DBUser=zabbix" \
    --env="ZS_DBPassword=my_password" \
    zabbix/zabbix-server-2.4    
# wait 60 seconds for Zabbix server initialization
# Zabbix web will be available on the port 80, Zabbix server on the port 10051
Zabbix database as Docker container
To be able to connect to database we would need one to be running first.
Easiest way to do that is to use another docker image.
For this purpose you can use [zabbix/zabbix-db-mariadb]
(https://registry.hub.docker.com/u/zabbix/zabbix-db-mariadb) image as database.

For more information about zabbix/zabbix-db-mariadb see [documentation.]
(https://github.com/zabbix/zabbix-community-docker)

Example:

docker run \
    -d \
    --name zabbix-db \
    -p 3306:3306 \
    --env="MARIADB_USER=zabbix" \
    --env="MARIADB_PASS=my_password" \
    zabbix/zabbix-db-mariadb
Remember to use the same credentials when deploying zabbix-server image.

Environmental variables
In this Image you can use environmental variables to config Zabbix server and
PHP. Available variables:

Variable	Default value
PHP_date_timezone	UTC
PHP_max_execution_time	300
PHP_max_input_time	300
PHP_memory_limit	128M
PHP_error_reporting	E_ALL
ZS_ListenPort	10051
ZS_SourceIP	
ZS_LogFile	/tmp/zabbix_server.log
ZS_LogFileSize	10
ZS_DebugLevel	3
ZS_PidFile	/var/run/zabbix_server.pid
ZS_DBHost	zabbix.db
ZS_DBName	zabbix
ZS_DBSchema	
ZS_DBUser	zabbix
ZS_DBPassword	zabbix
ZS_DBSocket	/tmp/mysql.sock
ZS_DBPort	3306
ZS_StartPollers	5
ZS_StartPollersUnreachable	1
ZS_StartTrappers	5
ZS_StartPingers	1
ZS_StartDiscoverers	1
ZS_StartHTTPPollers	1
ZS_StartTimers	1
ZS_JavaGateway	127.0.0.1
ZS_JavaGatewayPort	10052
ZS_StartJavaPollers	0
ZS_StartVMwareCollectors	0
ZS_VMwareFrequency	60
ZS_VMwarePerfFrequency	60
ZS_VMwareCacheSize	8M
ZS_VMwareTimeout	10
ZS_SNMPTrapperFile	/tmp/zabbix_traps.tmp
ZS_StartSNMPTrapper	0
ZS_ListenIP	0.0.0.0
ZS_HousekeepingFrequency	1
ZS_MaxHousekeeperDelete	500
ZS_SenderFrequency	30
ZS_CacheSize	8M
ZS_CacheUpdateFrequency	60
ZS_StartDBSyncers	4
ZS_HistoryCacheSize	8M
ZS_TrendCacheSize	4M
ZS_HistoryTextCacheSize	16M
ZS_ValueCacheSize	8M
ZS_Timeout	3
ZS_TrapperTimeout	300
ZS_UnreachablePeriod	45
ZS_UnavailableDelay	60
ZS_UnreachableDelay	15
ZS_AlertScriptsPath	/usr/local/share/zabbix/alertscripts
ZS_ExternalScripts	/usr/local/share/zabbix/externalscripts
ZS_FpingLocation	/usr/sbin/fping
ZS_Fping6Location	/usr/sbin/fping6
ZS_SSHKeyLocation	
ZS_LogSlowQueries	0
ZS_TmpDir	/tmp
ZS_StartProxyPollers	1
ZS_ProxyConfigFrequency	3600
ZS_ProxyDataFrequency	1
ZS_AllowRoot	0
ZS_User	zabbix
ZS_Include	
ZS_SSLCertLocation	/usr/local/share/zabbix/ssl/certs
ZS_SSLKeyLocation	/usr/local/share/zabbix/ssl/keys
ZS_SSLCALocation	
ZS_LoadModulePath	/usr/lib/zabbix/modules
ZS_LoadModule
Configuration from volume
Full config files can be also used. Environment configs will be overriden by
values from config files in this case. You need only to add /etc/custom-config/
volume:

-v /host/custom-config/:/etc/custom-config/
Available files:

File	Description
php-zabbix.ini	PHP configuration file
zabbix_server.conf	Zabbix server configuration file
Zabbix server deployment
Now when we have Zabbix database running we can deploy zabbix-server image with
appropriate environmental variables set.

Example:

docker run \
    -d \
    --name zabbix-server \
    -p 80:80 \
    -p 10051:10051 \
    --link zabbix-db:zabbix.db \
    --env="ZS_DBHost=zabbix.db" \
    --env="ZS_DBUser=zabbix" \
    --env="ZS_DBPassword=my_password" \
    zabbix/zabbix-server-2.4
Access to Zabbix web interface
To log in into zabbix web interface for the first time use credentials
Admin:zabbix.

Access web interface under

Docker troubleshooting
Use docker command to see if all required containers are up and running:

$ docker ps
Check online logs of Zabbix container:

$ docker logs zabbix-server
Sometimes you might just want to review how things are deployed inside a running
container, you can do this by executing a bash shell through docker's
exec command:

docker exec -ti zabbix-server /bin/bash
History of an image and size of layers:

docker history --no-trunc=true zabbix/zabbix-server-2.4 | tr -s ' ' | tail -n+2 | awk -F " ago " '{print $2}'
Run specific Zabbix server version, e.g. 2.4.4 - just specify 2.4.4 tag for image:

    docker run \
        -d \
        --name zabbix-server \
        -p 80:80 \
        -p 10051:10051 \
        --link zabbix-db:zabbix.db \
        --env="ZS_DBHost=zabbix.db" \
        --env="ZS_DBUser=zabbix" \
        --env="ZS_DBPassword=my_password" \
        zabbix/zabbix-server-2.4:2.4.4
